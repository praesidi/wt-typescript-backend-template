# Шаблон для бэкенда/агента на TypeScript + Gulp

Готовый пресет на основе gulp, gulp-include и webtutor-types - библиотеки для разработки бэкенда на TypeScript.

В проекте в качестве менеджера пакетов используется yarn, если он у вас еще не установлен, то можете сделать это командой

```bash
npm install --global yarn
```

## Операции

### Отслеживание изменений

Начать отслеживание изменения файлов можно командой:

```bash
yarn start
```

Позволяет автоматически при сохранении делать транспиляцию и сборку файла

### Сборка проекта

Для сборки используйте команду:

```bash
yarn build
```

## Особенности

Библиотека gulp-include позволяет вставить код одного файла в другой, что добавило возможность разбиения логики на модули. Это позволяет нам структурировать наш проект, делая его более удобным для работы.

Однако, чтобы избежать ошибок и конфликтов в проекте, необходимо использовать уникальные имена функций на всем проекте. Это значит, что каждая функция должна иметь уникальное имя, чтобы избежать пересечений и непредвиденных проблем.

### Использование библиотеки gulp-include

Для использования библиотеки gulp-include добавьте специальные метки в ваши файлы, чтобы указать, какой код нужно вставить. Например:

```js
//= include path/to/your/module.js
```

Эта строка позволит вставить содержимое файла module.js в текущий файл. Таким образом, вы можете легко объединять различные модули и файлы в один, делая код более структурированным и понятным.

## Конфигурация

### Конфигурация путей и файлов

Определяются в директории `gulp/consts.ts`.

- `SRC_PATH` - путь к корню проекта
- `TS_CONFIG_PATH` - путь к конфиг файлу ts
- `BUILD_PATH` - путь к папке билда
- `WATCHED_TS_TYPES` - отслеживаемые **при сохранении** и транспилируемые ts пути или файлы
- `WATCHED_OTHER_TYPES` - отслеживаемые **при сохранении** пути или файлы других типов (можете добавлять любые расширения которые вам нужны)
- `WATCHED_ADDED_TYPES` - отслеживаемые **при создании** пути или файлы
- `WATCHED_DEL_FILES` - отс леживаемые **при удалении** пути или файлы

По умолчанию для билда отслеживаются все пути прописанные в `consts`, но только при отслеживании файлов. При сборке через `yarn build` по умолчанию собираются только ts файлы. Если необходимо изменить эту логику - меняйте `task-dev, task-build` в файле `gulp.ts`

### Конфигурация ts

В `src/tsconfig.json` определяется основная конфигурация для ts файлов бекенда.<br/>
Подключаемые директории прописываются в `include`:

```json
"include": [
	"./**/*.ts"
]
```

## Процесс

Весь процесс сборки ts состоит из:

- Линтирования ESlint
- Автофикса по линту если это возможно
- Транспилирования файла ts
  - Замена импртов и экспортов
  - createProject на основе tsconfig файла и подключенных в нем библиотек
  - Замена символов \n \t, при конвертации мультилайн строк, в переносы и табуляции
- Добавление в транспилированный файл обрамляющих конструкций `<%...%>`
- Изменения кодировки файла на ufeff - utf8-with-bom
- Сохранение в папку билда

Настройки для .eslintrc.json должны быть едиными на всех проектах.
